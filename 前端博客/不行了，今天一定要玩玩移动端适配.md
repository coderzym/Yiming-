## 前言

有一段时间特别沉迷于`移动端`的适配，但一直没有动手。这不，即使在之前的文章`很多坑未填`的情况下，今天也要把移动端的适配整一整！这里就先不用`webpack`了，Yiming打算用`静态页面`演示下，也算是自己的一个总结。

在选型上，因为之前用`rem`写过一个小demo，所以这次用`vw`作为单位，一成不变多没意思。

![](https://user-gold-cdn.xitu.io/2020/6/3/1727902d079aaa64?w=1200&h=655&f=jpeg&s=588774)

## 安装Scss

因为Yiming用的是`VS Code`，所以只安装了`Easy Sass`。这里是中文网的链接，感兴趣的朋友也可以去看看：[Sass中文网](https://www.sass.hk/guide/)(已Get优雅丢链接的技能)。

可能会有朋友问`Sass和Scss有什么区别？`

我的理解是，`Scss是Sass的升级版`，后缀名写`Sass和Scss都可以`。这里我以`scss`为后缀名。目录结构也并不复杂：

- index.css
- index.html
- index.scss
- index.min.css(这个是编译后自动生成的，我引入的也是这个样式)

## 想想写个啥Demo

这里就写一个`二次元人物图库`吧！先施工HTML吧：

```
<main>
    <img src="./coser/1.png" alt="">
    <img src="./coser/2.png" alt="">
    <img src="./coser/3.png" alt="">
    <img src="./coser/4.png" alt="">
    <img src="./coser/5.png" alt="">
</main>
```

别嫌这个demo简单啦，复杂的HTML也不过是由它们拼凑而成的，页面效果先不上了，有点大~继续施工CSS

## CSS咋写

在Yiming的印象中，移动端开发要涉及到`1px问题`、`多设备问题`，而目前Yiming所接触的PC端开发都是设置`min-width/max-width + 处理好居中`，布局一般就没什么问题。

在移动端开发中，会涉及到CSS像素、设备像素、设备独立像素、DPR等知识，这里只说`设备像素、设备独立像素、DPR`，以`IPhone 6`为例：

- 设备像素。设备上真实的像素点，出厂时就已经确定，`IPhone 6`是750
- 设备独立像素。可以理解为CSS像素，`IPhone 6`是375，也就是谷歌调试器上的`width数值`
- DPR，设备像素比。调节设备像素和设备独立像素的关系，让我们的屏幕看起来清晰而不糊，计算公式：DPR = 设备像素 / 设备独立像素。
- 记得`1px像素`的问题吗？当DPR=2的时候，即1设备独立像素应该包含2个设备像素，也就是1px = 2个设备像素。设计师以1个设备像素来画的图，所以我们得写成0.5px设备独立像素(CSS像素)

## Scss函数

我们知道`1vw=屏幕视口的1%`，因为设计师是以设备像素，也就是750来定的，而375是咱们的CSS像素，所以计算vw的公式就是：

```
// 独立像素
$design: 750;
// px转vw
@function vw($px) {
    @return ($px / $design / 2) * 100vw;
}

main img {
    width: vw(375);
}
```

现在可以发效果图了：

![](https://user-gold-cdn.xitu.io/2020/6/3/1727990d4b9b13d0?w=892&h=855&f=gif&s=4175890)

## 优化

不知道大家有没有发现，虽然看上去没问题，但无法设置`min-width/max-width`，那很简单啦，加上这个属性就欧了~

![](https://user-gold-cdn.xitu.io/2020/6/3/17279c3af3f08bd8?w=1136&h=1400&f=png&s=210155)

最后来看看效果：

![](https://user-gold-cdn.xitu.io/2020/6/3/17279c94e5af4c20?w=955&h=855&f=gif&s=4575760)

## max-width改成min-width呢？

突发奇想，上面的代码中，html根字体是这样设置的：

```
@media screen and (max-width:540px) {
    font-size: 54px;
}
// 设置一个范围
@media screen and (max-width:320px) {
    font-size: 32px;
}
```

OK！立马动手，其实也就把`max-width`换成`min-width`啦！

```
@media screen and (min-width:540px) {
    font-size: 54px;
}
// 设置一个范围
@media screen and (min-width:320px) {
    font-size: 32px;
}
```

这个时候再来看看效果：

![](https://user-gold-cdn.xitu.io/2020/6/3/17279d10987a17ea?w=955&h=855&f=gif&s=3307709)

**有点意思**，其实这一种只是Yiming在试着玩，实际开发中，还是上一种用的比较多。

## 万恶的1px问题

这个在面试中也经常被问到(比如今天早上的电面)，原因上面也讲啦，就是在DPR = 2的情况下，1px变粗了，我比较喜欢设置伪元素：

- 设置伪元素

```
.border-1px {
    position: relative;
    &::before {
        content: "";
        width: 200%;
        height: 200%;
        position: absolute;
        left: 0;
        top: 0;
        transform-origin: left top;
        border: 1px solid red;
        transform: scale(0.5);
        pointer-events: none;
        @media screen and (min-device-pixel-ratio:3) {
            width: 300%;
            height: 300%;
            transform: scale(0.33);
        }
    }
}
```

我是这样记的：

1. 先将宽高设置为200%，并且用transform缩放0.5
2. 因为是伪元素，所以content不能少
3. 担心会触发事件，设置`pointer-events：none`
4. `transform-origin`，让伪元素原点和元素原点重合

至于其他的方法，大家就直接掘金搜索吧！哈哈！

## 写在后面

我移动端写的比较少，所以希望专攻移动端的朋友可以**给出宝贵的建议**，以免误导其他人，这篇文章也是自己对于移动端的这种适配没有深入研究，还看到过一种说法：`用户买DRP高的设备不是为了看更大的字，而是为了看更多的内容`，如果有这种需求的话，也可以使用vw + rem作布局单位，px作内容单位。

最后，文中原图搜P站和半次元吧！